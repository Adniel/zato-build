---

  - name: add Debian backports repository
    apt_repository: repo="deb http://ftp.is.debian.org/debian wheezy-backports main" state=present
    when: ansible_distribution == "Debian"

  - name: Do 'apt-get update' on Debian
    apt: update_cache=yes
    when: ansible_distribution == "Debian"

  - name: Install git on Debian
    apt: name=git state=present
    when: ansible_os_family == "Debian"

  - name: Install common packages on Centos
    yum: name={{ item }} state=present
    with_items:
      - git
      - gcc
      - make
      - openssl-devel
      - postgresql-devel
      - sqlite-devel
    when: ansible_distribution == "CentOS"

  - name: Install additional programs on CentOS 6
    yum: name={{ item }} state=present
    with_items:
      - libev
      - libev-devel
      - libffi
      - libffi-devel
      - bzip2
      - bzip2-devel
    when: ansible_distribution == "CentOS" and ansible_distribution_version.split('.')[0]|int == 6

  - name: Install pip on Centos 7
    easy_install: name=pip
    when: ansible_distribution == "CentOS" and ansible_distribution_version.split('.')[0]|int == 7
