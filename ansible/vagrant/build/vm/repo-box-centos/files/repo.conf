LoadModule ssl_module modules/mod_ssl.so
Listen 443
SSLPassPhraseDialog  builtin
SSLSessionCache         shmcb:/var/cache/mod_ssl/scache(512000)
SSLSessionCacheTimeout  300
SSLMutex default
SSLRandomSeed startup file:/dev/urandom  256
SSLRandomSeed connect builtin
SSLCryptoDevice builtin

<VirtualHost *:443>
	ServerName repo-box-ubuntu

	ServerAdmin rafal@zato.io
	DocumentRoot /var/www

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	SSLEngine on
	SSLProtocol all -SSLv2
	SSLCipherSuite DEFAULT:!EXP:!SSLv2:!DES:!IDEA:!SEED:+3DES
	SSLCertificateFile /etc/pki/tls/certs/ca.crt
	SSLCertificateKeyFile /etc/pki/tls/private/ca.key

	<FilesMatch "\.(cgi|shtml|phtml|php)$">
		SSLOptions +StdEnvVars
		</FilesMatch>
		<Directory /usr/lib/cgi-bin>
		SSLOptions +StdEnvVars
		</Directory>
		BrowserMatch "MSIE [2-6]" \
		nokeepalive ssl-unclean-shutdown \
		downgrade-1.0 force-response-1.0
		BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown
	#Include conf-available/serve-cgi-bin.conf

	<Directory /var/www/repo/ >
		Options Indexes FollowSymLinks Multiviews
		Order allow,deny
		Allow from all
	</Directory>

	<Directory "/var/www/repo/*/db/">
		Order deny,allow
		Deny from all
	</Directory>

	<Directory "/var/www/repo/*/conf/">
		Order deny,allow
		Deny from all
	</Directory>

	<Directory "/var/www/repo/incoming/">
		Order allow,deny
		Deny from all
	</Directory>

</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
